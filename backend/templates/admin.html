<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Society Bank Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>
    <style>
        body { font-family: 'Inter', Arial, sans-serif; }
        .sidebar-link-active { background: #0a52b9; color: #fff; }
        .sidebar-link { color: #374151; }
        .sidebar-link:hover { background: #f7b500; color: #0a52b9; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex">
    <!-- Sidebar -->
    <aside class="bg-white w-20 md:w-64 flex flex-col shadow-lg">
        <div class="flex items-center justify-center md:justify-start md:px-6 h-16 border-b border-gray-200">
            <span class="hidden md:block text-2xl font-semibold text-indigo-600">Society Bank</span>
            <i class="fas fa-university text-indigo-600 text-3xl md:hidden"></i>
        </div>
        <nav class="flex flex-col mt-6 space-y-1 px-2 md:px-6">
            <a class="flex items-center space-x-3 py-3 px-3 rounded-lg sidebar-link-active" href="{{ url_for('admin') }}">
                <i class="fas fa-tachometer-alt text-lg"></i>
                <span class="hidden md:block font-semibold">Dashboard</span>
            </a>
            <a class="flex items-center space-x-3 py-3 px-3 rounded-lg sidebar-link" href="{{ url_for('list_members') }}">
                <i class="fas fa-users text-lg"></i>
                <span class="hidden md:block font-semibold">Members</span>
            </a>
            <a class="flex items-center space-x-3 py-3 px-3 rounded-lg sidebar-link" href="{{ url_for('list_accounts') }}">
                <i class="fas fa-university text-lg"></i>
                <span class="hidden md:block font-semibold">Accounts</span>
            </a>
            <a class="flex items-center space-x-3 py-3 px-3 rounded-lg sidebar-link" href="{{ url_for('list_loans') }}">
                <i class="fas fa-file-invoice-dollar text-lg"></i>
                <span class="hidden md:block font-semibold">Loans</span>
            </a>
            <a class="flex items-center space-x-3 py-3 px-3 rounded-lg sidebar-link" href="{{ url_for('list_transactions') }}">
                <i class="fas fa-exchange-alt text-lg"></i>
                <span class="hidden md:block font-semibold">Transactions</span>
            </a>
            <a class="flex items-center space-x-3 py-3 px-3 rounded-lg" style="background:#f7b500;color:#0a52b9;" href="{{ url_for('admin_add_member') }}">
                <i class="fas fa-user-plus text-lg"></i>
                <span class="hidden md:block font-semibold">Add Member</span>
            </a>
            <a class="flex items-center space-x-3 py-3 px-3 rounded-lg sidebar-link" href="#settings-section">
                <i class="fas fa-cog text-lg"></i>
                <span class="hidden md:block font-semibold">Settings</span>
            </a>
        </nav>
    </aside>
    <!-- Main content -->
    <main class="flex-1 p-6 md:p-10">
        <!-- Header -->
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-indigo-700 flex items-center gap-2">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </h1>
            <div class="flex items-center space-x-4">
                <button class="relative text-gray-600 hover:text-gray-900 focus:outline-none">
                    <i class="fas fa-bell text-xl"></i>
                    <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5">5</span>
                </button>
                <img alt="User avatar" class="w-10 h-10 rounded-full object-cover" src="https://via.placeholder.com/40" />
                <a href="{{ url_for('logout') }}"
                   class="ml-2 px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition"
                >Logout</a>
            </div>
        </header>
        <!-- Dashboard Stats -->
        <section class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
            <div class="bg-yellow-400 rounded-lg p-6 shadow flex flex-col items-center">
                <i class="fas fa-users text-3xl text-indigo-700 mb-2"></i>
                <span class="text-xl font-bold text-indigo-700">{{ members_count }}</span>
                <span class="text-gray-700">Members</span>
            </div>
            <div class="bg-indigo-100 rounded-lg p-6 shadow flex flex-col items-center">
                <i class="fas fa-file-invoice-dollar text-3xl text-indigo-700 mb-2"></i>
                <span class="text-xl font-bold text-indigo-700">{{ loans_count }}</span>
                <span class="text-gray-700">Loans</span>
            </div>
            <div class="bg-green-100 rounded-lg p-6 shadow flex flex-col items-center">
                <i class="fas fa-university text-3xl text-indigo-700 mb-2"></i>
                <span class="text-xl font-bold text-indigo-700">{{ accounts_count }}</span>
                <span class="text-gray-700">Accounts</span>
            </div>
            <div class="bg-pink-100 rounded-lg p-6 shadow flex flex-col items-center">
                <i class="fas fa-exchange-alt text-3xl text-indigo-700 mb-2"></i>
                <span class="text-xl font-bold text-indigo-700">{{ transactions_count }}</span>
                <span class="text-gray-700">Transactions</span>
            </div>
        </section>
        <!-- Announcements -->
        <section class="bg-white rounded-lg p-6 shadow mb-8">
            <h3 class="text-lg font-semibold text-gray-900 mb-6">Post Announcement</h3>
            <form action="{{ url_for('manage_announcements') }}" method="POST" class="flex flex-col md:flex-row gap-4">
                <input type="text" name="message" placeholder="Enter announcement..." class="flex-1 border px-4 py-2 rounded" required>
                <button type="submit" class="bg-indigo-600 text-white px-6 py-2 rounded hover:bg-indigo-700">Post</button>
            </form>
            <div class="mt-4">
                <h4 class="font-semibold mb-2">Recent Announcements:</h4>
                <ul>
                    {% for announcement in announcements %}
                        <li class="text-gray-700 text-sm mb-1">{{ announcement.message }} <span class="text-xs text-gray-400">({{ announcement.created_at }})</span></li>
                    {% else %}
                        <li class="text-gray-500">No announcements yet.</li>
                    {% endfor %}
                </ul>
            </div>
        </section>
        <!-- Quick Reports -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-lg p-6 shadow">
                <h3 class="text-lg font-semibold text-gray-900 mb-6">Recent Members</h3>
                <table class="w-full border-collapse border border-gray-300">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-4 py-2">Name</th>
                            <th class="border border-gray-300 px-4 py-2">Account No.</th>
                            <th class="border border-gray-300 px-4 py-2">Email</th>
                            <th class="border border-gray-300 px-4 py-2">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for member in recent_members %}
                        <tr>
                            <td class="border border-gray-300 px-4 py-2">{{ member.name }}</td>
                            <td class="border border-gray-300 px-4 py-2">{{ member.account_no }}</td>
                            <td class="border border-gray-300 px-4 py-2">{{ member.email }}</td>
                            <td class="border border-gray-300 px-4 py-2">
                                <span class="px-2 py-1 rounded {{ 'bg-green-200 text-green-800' if member.is_approved else 'bg-yellow-200 text-yellow-800' }}">
                                    {{ 'Approved' if member.is_approved else 'Pending' }}
                                </span>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="4" class="text-gray-500">No recent members.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="bg-white rounded-lg p-6 shadow">
                <h3 class="text-lg font-semibold text-gray-900 mb-6">Recent Loans</h3>
                <table class="w-full border-collapse border border-gray-300">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-4 py-2">Loan ID</th>
                            <th class="border border-gray-300 px-4 py-2">Member</th>
                            <th class="border border-gray-300 px-4 py-2">Amount</th>
                            <th class="border border-gray-300 px-4 py-2">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for loan in recent_loans %}
                        <tr>
                            <td class="border border-gray-300 px-4 py-2">{{ loan.id }}</td>
                            <td class="border border-gray-300 px-4 py-2">{{ loan.member_id }}</td>
                            <td class="border border-gray-300 px-4 py-2">{{ loan.amount }}</td>
                            <td class="border border-gray-300 px-4 py-2">
                                <span class="px-2 py-1 rounded {{ 'bg-green-200 text-green-800' if loan.status == 'Approved' else 'bg-yellow-200 text-yellow-800' }}">
                                    {{ loan.status }}
                                </span>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="4" class="text-gray-500">No recent loans.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </section>
        <!-- Performance Chart -->
        <section class="bg-white rounded-lg p-6 shadow mb-8">
            <h3 class="text-lg font-semibold text-gray-900 mb-6">Performance Report</h3>
            <p class="text-gray-700 mb-4">Tracking member and loan trends over the last months.</p>
            <div class="w-full h-48">
                <svg aria-label="Bar chart showing performance report" class="w-full h-full" viewBox="0 0 100 50">
                    <rect fill="#4F46E5" height="20" width="10" x="5" y="30"></rect>
                    <rect fill="#4338CA" height="30" width="10" x="20" y="20"></rect>
                    <rect fill="#6366F1" height="40" width="10" x="35" y="10"></rect>
                    <rect fill="#4F46E5" height="25" width="10" x="50" y="25"></rect>
                    <rect fill="#4338CA" height="35" width="10" x="65" y="15"></rect>
                    <rect fill="#6366F1" height="45" width="10" x="80" y="5"></rect>
                </svg>
            </div>
        </section>
    </main>
</body>
</html>